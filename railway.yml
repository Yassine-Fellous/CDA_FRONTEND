# Configuration Railway pour SportMap Frontend
version: 2

# Configuration du build
build:
  # Commandes de build
  buildCommand: npm ci && npm run build
  # Dossier de sortie
  outputDirectory: dist

# Configuration du déploiement
deploy:
  # Commande de démarrage
  startCommand: npm run preview -- --host 0.0.0.0 --port $PORT
  # Port d'écoute (Railway injecte automatiquement $PORT)
  port: $PORT
  # Timeout de santé
  healthcheck:
    path: /
    timeout: 300
    interval: 30

# Variables d'environnement (à définir dans Railway Dashboard)
environments:
  production:
    NODE_ENV: production
    # Ces variables doivent être définies dans Railway Dashboard
    # VITE_MAPBOX_TOKEN: your_mapbox_token
    # VITE_API_URL: https://apisportmap-production.up.railway.app/api
    # VITE_ENABLE_MOCK: false

# Configuration des ressources
resources:
  # Mémoire allouée
  memory: 512Mi
  # CPU alloué
  cpu: 500m

# Configuration du domaine
networking:
  # Railway générera automatiquement un domaine .railway.app
  # Vous pouvez ajouter un domaine personnalisé via le Dashboard

# Optimisations
optimization:
  # Activer la compression
  compression: true
  # Cache statique
  staticFiles:
    - path: "/assets/*"
      headers:
        Cache-Control: "public, max-age=31536000, immutable"
    - path: "/*.js"
      headers:
        Cache-Control: "public, max-age=31536000, immutable"
    - path: "/*.css"
      headers:
        Cache-Control: "public, max-age=31536000, immutable"

# Configuration des logs
logging:
  level: info
  format: json